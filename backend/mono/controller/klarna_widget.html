
      <!DOCTYPE html>
      <html lang="en">
      <head>
          <meta charset="UTF-8">
          <meta name="viewport" content="width=device-width, initial-scale=1.0">
          <title></title>
      </head>
      <body>
          <div id="klarna-payments-container"></div>
          <button id="authorize-button">Authorize Payment</button>
          <script src="https://x.klarnacdn.net/kp/lib/v1/api.js" async></script>
          <script>
              window.addEventListener('load', function () {
                  Klarna.Payments.init({
                      client_token: 'eyJhbGciOiJSUzI1NiIsImtpZCI6IjgyMzA1ZWJjLWI4MTEtMzYzNy1hYTRjLTY2ZWNhMTg3NGYzZCJ9.eyJzZXNzaW9uX2lkIjoiZmViZGE4OGYtZDExMC01MzQ1LThkNWQtMjQxMzIzNDY0MDlkIiwiYmFzZV91cmwiOiJodHRwczovL2pzLnBsYXlncm91bmQua2xhcm5hLmNvbS9ldS9rcCIsImRlc2lnbiI6ImtsYXJuYSIsImxhbmd1YWdlIjoiZW4iLCJwdXJjaGFzZV9jb3VudHJ5IjoiU0UiLCJlbnZpcm9ubWVudCI6InBsYXlncm91bmQiLCJtZXJjaGFudF9uYW1lIjoiWW91ciBidXNpbmVzcyBuYW1lIiwic2Vzc2lvbl90eXBlIjoiUEFZTUVOVFMiLCJjbGllbnRfZXZlbnRfYmFzZV91cmwiOiJodHRwczovL2V1LnBsYXlncm91bmQua2xhcm5hZXZ0LmNvbSIsInNjaGVtZSI6dHJ1ZSwiZXhwZXJpbWVudHMiOlt7Im5hbWUiOiJrcC1jbGllbnQtb25lLXB1cmNoYXNlLWZsb3ciLCJ2YXJpYXRlIjoidmFyaWF0ZS0xIn0seyJuYW1lIjoia3BjLTFrLXNlcnZpY2UiLCJ2YXJpYXRlIjoidmFyaWF0ZS0xIn0seyJuYW1lIjoia3AtY2xpZW50LXV0b3BpYS1mbG93IiwidmFyaWF0ZSI6InZhcmlhdGUtMSJ9LHsibmFtZSI6ImtwLWNsaWVudC11dG9waWEtc3RhdGljLXdpZGdldCIsInZhcmlhdGUiOiJpbmRleCIsInBhcmFtZXRlcnMiOnsiZHluYW1pYyI6InRydWUifX0seyJuYW1lIjoiaW4tYXBwLXNkay1uZXctaW50ZXJuYWwtYnJvd3NlciIsInBhcmFtZXRlcnMiOnsidmFyaWF0ZV9pZCI6Im5ldy1pbnRlcm5hbC1icm93c2VyLWVuYWJsZSJ9fSx7Im5hbWUiOiJrcC1jbGllbnQtdXRvcGlhLXNkay1mbG93IiwidmFyaWF0ZSI6InZhcmlhdGUtMSJ9LHsibmFtZSI6ImtwLWNsaWVudC11dG9waWEtd2Vidmlldy1mbG93IiwidmFyaWF0ZSI6InZhcmlhdGUtMSJ9LHsibmFtZSI6ImluLWFwcC1zZGstY2FyZC1zY2FubmluZyIsInBhcmFtZXRlcnMiOnsidmFyaWF0ZV9pZCI6ImNhcmQtc2Nhbm5pbmctZW5hYmxlIn19XSwicmVnaW9uIjoiZXUiLCJvcmRlcl9hbW91bnQiOjEwMDAsIm9mZmVyaW5nX29wdHMiOjIsIm9vIjoiNXUiLCJ2ZXJzaW9uIjoidjEuMTAuMC0xNTkwLWczZWJjMzkwNyJ9.CxbgWUmXCP6cZd8ATB7kxvTF4UbcYw5aYvfvEQM1ElLgHGgi7uMjAcuAKxgWNMCDguV0RD6k9s8YeQVdoDtODHRO59NvrMYHjsR56-JF5AKFJfdJVwXIewHBUCX16yvkT07ob7Fl9xd0zFDd-PMDw0oqBfPMfmlDxCP5sYDmXrCy-N5LnIb8mFqpw0mvXtb4lbc_j7EwOg1y7-HFgwKknFrzlzv94tUQITJbiMJeCdrryDQczvO4d5qF59xFHEefJ_MvKs43l8ZbvR3XhUdpA8qw789_wTCeHEr1-Rvj7z8cVm5g7PIywjQx9RhAe63rVqeM1CpzisYW5umUEwlFAQ'
                  });
                  Klarna.Payments.load(
                      {
                          container: '#klarna-payments-container'
                      },
                      {},
                      function (res) {
                          console.debug(res);
                      }
                  )
                  document.getElementById('authorize-button').addEventListener('click', function() {
                      Klarna.Payments.authorize(
                          {},
                          {
                              billing_address: {
                                  given_name: "Alice",
                                  family_name: "Test",
                                  email: "customer@email.se",
                                  street_address: "Södra Blasieholmshamnen 2",
                                  postal_code: "11148",
                                  city: "Stockholm",
                                  phone: "+46701740615",
                                  country: "SE"
                              },
                              shipping_address: {
                                  given_name: "Alice",
                                  family_name: "Test",
                                  email: "customer@email.se",
                                  street_address: "Södra Blasieholmshamnen 2",
                                  postal_code: "11148",
                                  city: "Stockholm",
                                  phone: "+46701740615",
                                  country: "SE"
                              },
                              customer: {
                                  date_of_birth: "1941-03-21",
                              },
                          }, 
                          function(res) {   
                            <!-- res.approved == true -> call endpoint to update order in strapi with res.authorization_token -->
                            console.debug(res);
                            if (res.approved === true) {
                              const postToken = async () => {
                                const request = {
                                  method: 'PUT',
                                  headers: {
                                    Authorization: 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6NiwiaWF0IjoxNzEwODQ2OTIzLCJleHAiOjE3MTM0Mzg5MjN9.EGk4X544dPe2z9JHUM351UyGhOuGIxKRaSztaOAUH6c',
                                    'Content-Type': 'application/json'
                                  },
                                  body: JSON.stringify({
                                    data: {
                                      klarna_auth_token: res.authorization_token,
                                      Status: 'Authorized'
                                    }
                                  })
                                };
                                console.debug(request)
                                const response = await fetch('http://localhost:1337/api/orders/1', request);
                                
                                console.debug(response);
                              };
                              postToken();
                            }
                          }
                      );
                  });
              });
          </script>
      </body>
      </html>
  